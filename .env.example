# DHT Search 后端环境变量配置示例
# 复制此文件为 .env 并修改相应值

# ============================================
# MySQL 配置
# ============================================
DHT_MYSQL_HOST=localhost
DHT_MYSQL_PORT=3306
DHT_MYSQL_USER=dht_crawler
DHT_MYSQL_PASSWORD=your_password_here
DHT_MYSQL_DATABASE=dht_crawler
DHT_MYSQL_CHARSET=utf8mb4
DHT_MYSQL_POOL_SIZE=20
DHT_MYSQL_MAX_OVERFLOW=30

# ============================================
# Redis 配置
# ============================================
DHT_REDIS_HOST=localhost
DHT_REDIS_PORT=6379
DHT_REDIS_PASSWORD=  # 留空表示无密码
DHT_REDIS_DB=0
DHT_REDIS_POOL_SIZE=50

# ============================================
# DHT 爬虫配置
# ============================================
DHT_DHT_SERVERS=4
DHT_MAX_NODE_QSIZE=500
DHT_METADATA_WORKERS=400
DHT_METADATA_TIMEOUT=6

# ============================================
# 数据库写入配置
# ============================================
DHT_DB_BATCH_SIZE=100
DHT_DB_BATCH_TIMEOUT=10
DHT_DB_WRITER_WORKERS=4

# ============================================
# 数据过滤配置
# ============================================
DHT_MAX_TORRENT_AGE_DAYS=730
DHT_MIN_HEALTH_SCORE=5

# ============================================
# Redis 缓存配置
# ============================================
DHT_CACHE_HASH_TTL=604800
DHT_CACHE_HOT_TORRENTS_SIZE=100

# ============================================
# API 安全配置
# ============================================
# API 密钥配置（JSON 格式）
# 示例: DHT_API_KEYS_JSON='{"your_key": {"name": "Your Key Name", "rate_limit": 100, "enabled": true}}'
DHT_API_KEYS_JSON=

# 是否启用 API 密钥认证（生产环境设为 True）
DHT_API_KEY_AUTH=False

# 是否允许无密钥访问
DHT_ALLOW_NO_KEY_ACCESS=True

# 无密钥访问速率限制（每分钟请求数）
DHT_NO_KEY_RATE_LIMIT=20

# ============================================
# 速率限制配置
# ============================================
DHT_RATE_LIMIT_REDIS_HOST=localhost
DHT_RATE_LIMIT_REDIS_PORT=6379
DHT_RATE_LIMIT_REDIS_DB=1
DHT_RATE_LIMIT_WINDOW=60

# ============================================
# 安全检查配置
# ============================================
# 允许的 Referer 域名（逗号分隔）
DHT_ALLOWED_REFERERS=localhost,127.0.0.1,example.com

# 是否启用 Referer 检查
DHT_ENABLE_REFERER_CHECK=False

# 黑名单 IP（逗号分隔）
DHT_BLACKLIST_IPS=

# 白名单 IP（逗号分隔）
DHT_WHITELIST_IPS=127.0.0.1,localhost

# 已知爬虫 User-Agent（逗号分隔）
DHT_KNOWN_CRAWLERS=bot,crawler,spider,scraper,curl,wget

# 是否拦截爬虫
DHT_BLOCK_CRAWLERS=False
